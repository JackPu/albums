!function(e){"use strict";var t=e.HTMLCanvasElement&&e.HTMLCanvasElement.prototype,i=e.Blob&&function(){try{return Boolean(new Blob)}catch(e){return!1}}(),n=i&&e.Uint8Array&&function(){try{return 100===new Blob([new Uint8Array(100)]).size}catch(e){return!1}}(),r=e.BlobBuilder||e.WebKitBlobBuilder||e.MozBlobBuilder||e.MSBlobBuilder,a=(i||r)&&e.atob&&e.ArrayBuffer&&e.Uint8Array&&function(e){var t,a,o,s,l,p;for(t=e.split(",")[0].indexOf("base64")>=0?atob(e.split(",")[1]):decodeURIComponent(e.split(",")[1]),a=new ArrayBuffer(t.length),o=new Uint8Array(a),s=0;s<t.length;s+=1)o[s]=t.charCodeAt(s);return l=e.split(",")[0].split(":")[1].split(";")[0],i?new Blob([n?o:a],{type:l}):(p=new r,p.append(a),p.getBlob(l))};e.HTMLCanvasElement&&!t.toBlob&&(t.mozGetAsFile?t.toBlob=function(e,i,n){e(n&&t.toDataURL&&a?a(this.toDataURL(i,n)):this.mozGetAsFile("blob",i))}:t.toDataURL&&a&&(t.toBlob=function(e,t,i){e(a(this.toDataURL(t,i)))})),e.dataURLtoBlob=a}(window),function(e){"use strict";var t=function(e,i,n){var r,a,o=document.createElement("img");if(o.onerror=i,o.onload=function(){!a||n&&n.noRevoke||t.revokeObjectURL(a),i&&i(t.scale(o,n))},t.isInstanceOf("Blob",e)||t.isInstanceOf("File",e))r=a=t.createObjectURL(e),o._type=e.type;else{if("string"!=typeof e)return!1;r=e,n&&n.crossOrigin&&(o.crossOrigin=n.crossOrigin)}return r?(o.src=r,o):t.readFile(e,function(e){var t=e.target;t&&t.result?o.src=t.result:i&&i(e)})},i=window.createObjectURL&&window||window.URL&&URL.revokeObjectURL&&URL||window.webkitURL&&webkitURL;t.isInstanceOf=function(e,t){return Object.prototype.toString.call(t)==="[object "+e+"]"},t.transformCoordinates=function(){},t.getTransformedOptions=function(e,t){var i,n,r,a,o=t.aspectRatio;if(!o)return t;i={};for(n in t)t.hasOwnProperty(n)&&(i[n]=t[n]);return i.crop=!0,r=e.naturalWidth||e.width,a=e.naturalHeight||e.height,r/a>o?(i.maxWidth=a*o,i.maxHeight=a):(i.maxWidth=r,i.maxHeight=r/o),i},t.renderImageToCanvas=function(e,t,i,n,r,a,o,s,l,p){return e.getContext("2d").drawImage(t,i,n,r,a,o,s,l,p),e},t.hasCanvasOption=function(e){return e.canvas||e.crop||e.aspectRatio},t.scale=function(e,i){i=i||{};var n,r,a,o,s,l,p,u,d,c=document.createElement("canvas"),f=e.getContext||t.hasCanvasOption(i)&&c.getContext,g=e.naturalWidth||e.width,h=e.naturalHeight||e.height,m=g,v=h,_=function(){var e=Math.max((a||m)/m,(o||v)/v);e>1&&(m*=e,v*=e)},b=function(){var e=Math.min((n||m)/m,(r||v)/v);1>e&&(m*=e,v*=e)};return f&&(i=t.getTransformedOptions(e,i),p=i.left||0,u=i.top||0,i.sourceWidth?(s=i.sourceWidth,void 0!==i.right&&void 0===i.left&&(p=g-s-i.right)):s=g-p-(i.right||0),i.sourceHeight?(l=i.sourceHeight,void 0!==i.bottom&&void 0===i.top&&(u=h-l-i.bottom)):l=h-u-(i.bottom||0),m=s,v=l),n=i.maxWidth,r=i.maxHeight,a=i.minWidth,o=i.minHeight,f&&n&&r&&i.crop?(m=n,v=r,d=s/l-n/r,0>d?(l=r*s/n,void 0===i.top&&void 0===i.bottom&&(u=(h-l)/2)):d>0&&(s=n*l/r,void 0===i.left&&void 0===i.right&&(p=(g-s)/2))):((i.contain||i.cover)&&(a=n=n||a,o=r=r||o),i.cover?(b(),_()):(_(),b())),f?(c.width=m,c.height=v,t.transformCoordinates(c,i),t.renderImageToCanvas(c,e,p,u,s,l,0,0,m,v)):(e.width=m,e.height=v,e)},t.createObjectURL=function(e){return i?i.createObjectURL(e):!1},t.revokeObjectURL=function(e){return i?i.revokeObjectURL(e):!1},t.readFile=function(e,t,i){if(window.FileReader){var n=new FileReader;if(n.onload=n.onerror=t,i=i||"readAsDataURL",n[i])return n[i](e),n}return!1},e.loadImage=t}(window),function(e){"use strict";e(window.loadImage)}(function(e){"use strict";var t=window.Blob&&(Blob.prototype.slice||Blob.prototype.webkitSlice||Blob.prototype.mozSlice);e.blobSlice=t&&function(){var e=this.slice||this.webkitSlice||this.mozSlice;return e.apply(this,arguments)},e.metaDataParsers={jpeg:{65505:[]}},e.parseMetaData=function(t,i,n){n=n||{};var r=this,a=n.maxMetaDataSize||262144,o={},s=!(window.DataView&&t&&t.size>=12&&"image/jpeg"===t.type&&e.blobSlice);(s||!e.readFile(e.blobSlice.call(t,0,a),function(t){if(t.target.error)return console.log(t.target.error),void i(o);var a,s,l,p,u=t.target.result,d=new DataView(u),c=2,f=d.byteLength-4,g=c;if(65496===d.getUint16(0)){for(;f>c&&(a=d.getUint16(c),a>=65504&&65519>=a||65534===a);){if(s=d.getUint16(c+2)+2,c+s>d.byteLength){console.log("Invalid meta data: Invalid segment size.");break}if(l=e.metaDataParsers.jpeg[a])for(p=0;p<l.length;p+=1)l[p].call(r,d,c,s,o,n);c+=s,g=c}!n.disableImageHead&&g>6&&(u.slice?o.imageHead=u.slice(0,g):o.imageHead=new Uint8Array(u).subarray(0,g))}else console.log("Invalid JPEG file: Missing JPEG marker.");i(o)},"readAsArrayBuffer"))&&i(o)}}),function(e){"use strict";e(window.loadImage)}(function(e){"use strict";e.ExifMap=function(){return this},e.ExifMap.prototype.map={Orientation:274},e.ExifMap.prototype.get=function(e){return this[e]||this[this.map[e]]},e.getExifThumbnail=function(e,t,i){var n,r,a;if(!i||t+i>e.byteLength)return void console.log("Invalid Exif data: Invalid thumbnail data.");for(n=[],r=0;i>r;r+=1)a=e.getUint8(t+r),n.push((16>a?"0":"")+a.toString(16));return"data:image/jpeg,%"+n.join("%")},e.exifTagTypes={1:{getValue:function(e,t){return e.getUint8(t)},size:1},2:{getValue:function(e,t){return String.fromCharCode(e.getUint8(t))},size:1,ascii:!0},3:{getValue:function(e,t,i){return e.getUint16(t,i)},size:2},4:{getValue:function(e,t,i){return e.getUint32(t,i)},size:4},5:{getValue:function(e,t,i){return e.getUint32(t,i)/e.getUint32(t+4,i)},size:8},9:{getValue:function(e,t,i){return e.getInt32(t,i)},size:4},10:{getValue:function(e,t,i){return e.getInt32(t,i)/e.getInt32(t+4,i)},size:8}},e.exifTagTypes[7]=e.exifTagTypes[1],e.getExifValue=function(t,i,n,r,a,o){var s,l,p,u,d,c,f=e.exifTagTypes[r];if(!f)return void console.log("Invalid Exif data: Invalid tag type.");if(s=f.size*a,l=s>4?i+t.getUint32(n+8,o):n+8,l+s>t.byteLength)return void console.log("Invalid Exif data: Invalid data offset.");if(1===a)return f.getValue(t,l,o);for(p=[],u=0;a>u;u+=1)p[u]=f.getValue(t,l+u*f.size,o);if(f.ascii){for(d="",u=0;u<p.length&&(c=p[u],"\x00"!==c);u+=1)d+=c;return d}return p},e.parseExifTag=function(t,i,n,r,a){var o=t.getUint16(n,r);a.exif[o]=e.getExifValue(t,i,n,t.getUint16(n+2,r),t.getUint32(n+4,r),r)},e.parseExifTags=function(e,t,i,n,r){var a,o,s;if(i+6>e.byteLength)return void console.log("Invalid Exif data: Invalid directory offset.");if(a=e.getUint16(i,n),o=i+2+12*a,o+4>e.byteLength)return void console.log("Invalid Exif data: Invalid directory size.");for(s=0;a>s;s+=1)this.parseExifTag(e,t,i+2+12*s,n,r);return e.getUint32(o,n)},e.parseExifData=function(t,i,n,r,a){if(!a.disableExif){var o,s,l,p=i+10;if(1165519206===t.getUint32(i+4)){if(p+8>t.byteLength)return void console.log("Invalid Exif data: Invalid segment size.");if(0!==t.getUint16(i+8))return void console.log("Invalid Exif data: Missing byte alignment offset.");switch(t.getUint16(p)){case 18761:o=!0;break;case 19789:o=!1;break;default:return void console.log("Invalid Exif data: Invalid byte alignment marker.")}if(42!==t.getUint16(p+2,o))return void console.log("Invalid Exif data: Missing TIFF marker.");s=t.getUint32(p+4,o),r.exif=new e.ExifMap,s=e.parseExifTags(t,p,p+s,o,r),s&&!a.disableExifThumbnail&&(l={exif:{}},s=e.parseExifTags(t,p,p+s,o,l),l.exif[513]&&(r.exif.Thumbnail=e.getExifThumbnail(t,p+l.exif[513],l.exif[514]))),r.exif[34665]&&!a.disableExifSub&&e.parseExifTags(t,p,p+r.exif[34665],o,r),r.exif[34853]&&!a.disableExifGps&&e.parseExifTags(t,p,p+r.exif[34853],o,r)}}},e.metaDataParsers.jpeg[65505].push(e.parseExifData)}),function(e){"use strict";e(window.loadImage)}(function(e){"use strict";if(window.navigator&&window.navigator.platform&&/iP(hone|od|ad)/.test(window.navigator.platform)){var t=e.renderImageToCanvas;e.detectSubsampling=function(e){var t,i;return e.width*e.height>1048576?(t=document.createElement("canvas"),t.width=t.height=1,i=t.getContext("2d"),i.drawImage(e,-e.width+1,0),0===i.getImageData(0,0,1,1).data[3]):!1},e.detectVerticalSquash=function(e,t){var i,n,r,a,o,s=e.naturalHeight||e.height,l=document.createElement("canvas"),p=l.getContext("2d");for(t&&(s/=2),l.width=1,l.height=s,p.drawImage(e,0,0),i=p.getImageData(0,0,1,s).data,n=0,r=s,a=s;a>n;)o=i[4*(a-1)+3],0===o?r=a:n=a,a=r+n>>1;return a/s||1},e.renderImageToCanvas=function(i,n,r,a,o,s,l,p,u,d){if("image/jpeg"===n._type){var c,f,g,h,m=i.getContext("2d"),v=document.createElement("canvas"),_=1024,b=v.getContext("2d");if(v.width=_,v.height=_,m.save(),c=e.detectSubsampling(n),c&&(r/=2,a/=2,o/=2,s/=2),f=e.detectVerticalSquash(n,c),c||1!==f){for(a*=f,u=Math.ceil(_*u/o),d=Math.ceil(_*d/s/f),p=0,h=0;s>h;){for(l=0,g=0;o>g;)b.clearRect(0,0,_,_),b.drawImage(n,r,a,o,s,-g,-h,o,s),m.drawImage(v,0,0,_,_,l,p,u,d),g+=_,l+=u;h+=_,p+=d}return m.restore(),i}}return t(i,n,r,a,o,s,l,p,u,d)}}}),function(e){"use strict";e(window.jQuery)}(function(e){"use strict";function t(t){var i="dragover"===t;return function(n){n.dataTransfer=n.originalEvent&&n.originalEvent.dataTransfer;var r=n.dataTransfer;r&&-1!==e.inArray("Files",r.types)&&this._trigger(t,e.Event(t,{delegatedEvent:n}))!==!1&&(n.preventDefault(),i&&(r.dropEffect="copy"))}}e.support.fileInput=!(new RegExp("(Android (1\\.[0156]|2\\.[01]))|(Windows Phone (OS 7|8\\.0))|(XBLWP)|(ZuneWP)|(WPDesktop)|(w(eb)?OSBrowser)|(webOS)|(Kindle/(1\\.0|2\\.[05]|3\\.0))").test(window.navigator.userAgent)||e('<input type="file">').prop("disabled")),e.support.xhrFileUpload=!(!window.ProgressEvent||!window.FileReader),e.support.xhrFormDataFileUpload=!!window.FormData,e.support.blobSlice=window.Blob&&(Blob.prototype.slice||Blob.prototype.webkitSlice||Blob.prototype.mozSlice),e.widget("blueimp.fileupload",{options:{dropZone:e(document),pasteZone:void 0,fileInput:void 0,replaceFileInput:!0,paramName:void 0,singleFileUploads:!0,limitMultiFileUploads:void 0,limitMultiFileUploadSize:void 0,limitMultiFileUploadSizeOverhead:512,sequentialUploads:!1,limitConcurrentUploads:void 0,forceIframeTransport:!1,redirect:void 0,redirectParamName:void 0,postMessage:void 0,multipart:!0,maxChunkSize:void 0,uploadedBytes:void 0,recalculateProgress:!0,progressInterval:100,bitrateInterval:500,autoUpload:!0,messages:{uploadedBytes:"Uploaded bytes exceed file size"},i18n:function(t,i){return t=this.messages[t]||t.toString(),i&&e.each(i,function(e,i){t=t.replace("{"+e+"}",i)}),t},formData:function(e){return e.serializeArray()},add:function(t,i){return t.isDefaultPrevented()?!1:void((i.autoUpload||i.autoUpload!==!1&&e(this).fileupload("option","autoUpload"))&&i.process().done(function(){i.submit()}))},processData:!1,contentType:!1,cache:!1,timeout:0},_specialOptions:["fileInput","dropZone","pasteZone","multipart","forceIframeTransport"],_blobSlice:e.support.blobSlice&&function(){var e=this.slice||this.webkitSlice||this.mozSlice;return e.apply(this,arguments)},_BitrateTimer:function(){this.timestamp=Date.now?Date.now():(new Date).getTime(),this.loaded=0,this.bitrate=0,this.getBitrate=function(e,t,i){var n=e-this.timestamp;return(!this.bitrate||!i||n>i)&&(this.bitrate=(t-this.loaded)*(1e3/n)*8,this.loaded=t,this.timestamp=e),this.bitrate}},_isXHRUpload:function(t){return!t.forceIframeTransport&&(!t.multipart&&e.support.xhrFileUpload||e.support.xhrFormDataFileUpload)},_getFormData:function(t){var i;return"function"===e.type(t.formData)?t.formData(t.form):e.isArray(t.formData)?t.formData:"object"===e.type(t.formData)?(i=[],e.each(t.formData,function(e,t){i.push({name:e,value:t})}),i):[]},_getTotal:function(t){var i=0;return e.each(t,function(e,t){i+=t.size||1}),i},_initProgressObject:function(t){var i={loaded:0,total:0,bitrate:0};t._progress?e.extend(t._progress,i):t._progress=i},_initResponseObject:function(e){var t;if(e._response)for(t in e._response)e._response.hasOwnProperty(t)&&delete e._response[t];else e._response={}},_onProgress:function(t,i){if(t.lengthComputable){var n,r=Date.now?Date.now():(new Date).getTime();if(i._time&&i.progressInterval&&r-i._time<i.progressInterval&&t.loaded!==t.total)return;i._time=r,n=Math.floor(t.loaded/t.total*(i.chunkSize||i._progress.total))+(i.uploadedBytes||0),this._progress.loaded+=n-i._progress.loaded,this._progress.bitrate=this._bitrateTimer.getBitrate(r,this._progress.loaded,i.bitrateInterval),i._progress.loaded=i.loaded=n,i._progress.bitrate=i.bitrate=i._bitrateTimer.getBitrate(r,n,i.bitrateInterval),this._trigger("progress",e.Event("progress",{delegatedEvent:t}),i),this._trigger("progressall",e.Event("progressall",{delegatedEvent:t}),this._progress)}},_initProgressListener:function(t){var i=this,n=t.xhr?t.xhr():e.ajaxSettings.xhr();n.upload&&(e(n.upload).bind("progress",function(e){var n=e.originalEvent;e.lengthComputable=n.lengthComputable,e.loaded=n.loaded,e.total=n.total,i._onProgress(e,t)}),t.xhr=function(){return n})},_isInstanceOf:function(e,t){return Object.prototype.toString.call(t)==="[object "+e+"]"},_initXHRData:function(t){var i,n=this,r=t.files[0],a=t.multipart||!e.support.xhrFileUpload,o="array"===e.type(t.paramName)?t.paramName[0]:t.paramName;t.headers=e.extend({},t.headers),t.contentRange&&(t.headers["Content-Range"]=t.contentRange),a&&!t.blob&&this._isInstanceOf("File",r)||(t.headers["Content-Disposition"]='attachment; filename="'+encodeURI(r.name)+'"'),a?e.support.xhrFormDataFileUpload&&(t.postMessage?(i=this._getFormData(t),t.blob?i.push({name:o,value:t.blob}):e.each(t.files,function(n,r){i.push({name:"array"===e.type(t.paramName)&&t.paramName[n]||o,value:r})})):(n._isInstanceOf("FormData",t.formData)?i=t.formData:(i=new FormData,e.each(this._getFormData(t),function(e,t){i.append(t.name,t.value)})),t.blob?i.append(o,t.blob,r.name):e.each(t.files,function(r,a){(n._isInstanceOf("File",a)||n._isInstanceOf("Blob",a))&&i.append("array"===e.type(t.paramName)&&t.paramName[r]||o,a,a.uploadName||a.name)})),t.data=i):(t.contentType=r.type||"application/octet-stream",t.data=t.blob||r),t.blob=null},_initIframeSettings:function(t){var i=e("<a></a>").prop("href",t.url).prop("host");t.dataType="iframe "+(t.dataType||""),t.formData=this._getFormData(t),t.redirect&&i&&i!==location.host&&t.formData.push({name:t.redirectParamName||"redirect",value:t.redirect})},_initDataSettings:function(e){this._isXHRUpload(e)?(this._chunkedUpload(e,!0)||(e.data||this._initXHRData(e),this._initProgressListener(e)),e.postMessage&&(e.dataType="postmessage "+(e.dataType||""))):this._initIframeSettings(e)},_getParamName:function(t){var i=e(t.fileInput),n=t.paramName;return n?e.isArray(n)||(n=[n]):(n=[],i.each(function(){for(var t=e(this),i=t.prop("name")||"files[]",r=(t.prop("files")||[1]).length;r;)n.push(i),r-=1}),n.length||(n=[i.prop("name")||"files[]"])),n},_initFormSettings:function(t){t.form&&t.form.length||(t.form=e(t.fileInput.prop("form")),t.form.length||(t.form=e(this.options.fileInput.prop("form")))),t.paramName=this._getParamName(t),t.url||(t.url=t.form.prop("action")||location.href),t.type=(t.type||"string"===e.type(t.form.prop("method"))&&t.form.prop("method")||"").toUpperCase(),"POST"!==t.type&&"PUT"!==t.type&&"PATCH"!==t.type&&(t.type="POST"),t.formAcceptCharset||(t.formAcceptCharset=t.form.attr("accept-charset"))},_getAJAXSettings:function(t){var i=e.extend({},this.options,t);return this._initFormSettings(i),this._initDataSettings(i),i},_getDeferredState:function(e){return e.state?e.state():e.isResolved()?"resolved":e.isRejected()?"rejected":"pending"},_enhancePromise:function(e){return e.success=e.done,e.error=e.fail,e.complete=e.always,e},_getXHRPromise:function(t,i,n){var r=e.Deferred(),a=r.promise();return i=i||this.options.context||a,t===!0?r.resolveWith(i,n):t===!1&&r.rejectWith(i,n),a.abort=r.promise,this._enhancePromise(a)},_addConvenienceMethods:function(t,i){var n=this,r=function(t){return e.Deferred().resolveWith(n,t).promise()};i.process=function(t,a){return(t||a)&&(i._processQueue=this._processQueue=(this._processQueue||r([this])).pipe(function(){return i.errorThrown?e.Deferred().rejectWith(n,[i]).promise():r(arguments)}).pipe(t,a)),this._processQueue||r([this])},i.submit=function(){return"pending"!==this.state()&&(i.jqXHR=this.jqXHR=n._trigger("submit",e.Event("submit",{delegatedEvent:t}),this)!==!1&&n._onSend(t,this)),this.jqXHR||n._getXHRPromise()},i.abort=function(){return this.jqXHR?this.jqXHR.abort():(this.errorThrown="abort",n._trigger("fail",null,this),n._getXHRPromise(!1))},i.state=function(){return this.jqXHR?n._getDeferredState(this.jqXHR):this._processQueue?n._getDeferredState(this._processQueue):void 0},i.processing=function(){return!this.jqXHR&&this._processQueue&&"pending"===n._getDeferredState(this._processQueue)},i.progress=function(){return this._progress},i.response=function(){return this._response}},_getUploadedBytes:function(e){var t=e.getResponseHeader("Range"),i=t&&t.split("-"),n=i&&i.length>1&&parseInt(i[1],10);return n&&n+1},_chunkedUpload:function(t,i){t.uploadedBytes=t.uploadedBytes||0;var n,r,a=this,o=t.files[0],s=o.size,l=t.uploadedBytes,p=t.maxChunkSize||s,u=this._blobSlice,d=e.Deferred(),c=d.promise();return this._isXHRUpload(t)&&u&&(l||s>p)&&!t.data?i?!0:l>=s?(o.error=t.i18n("uploadedBytes"),this._getXHRPromise(!1,t.context,[null,"error",o.error])):(r=function(){var i=e.extend({},t),c=i._progress.loaded;i.blob=u.call(o,l,l+p,o.type),i.chunkSize=i.blob.size,i.contentRange="bytes "+l+"-"+(l+i.chunkSize-1)+"/"+s,a._initXHRData(i),a._initProgressListener(i),n=(a._trigger("chunksend",null,i)!==!1&&e.ajax(i)||a._getXHRPromise(!1,i.context)).done(function(n,o,p){l=a._getUploadedBytes(p)||l+i.chunkSize,c+i.chunkSize-i._progress.loaded&&a._onProgress(e.Event("progress",{lengthComputable:!0,loaded:l-i.uploadedBytes,total:l-i.uploadedBytes}),i),t.uploadedBytes=i.uploadedBytes=l,i.result=n,i.textStatus=o,i.jqXHR=p,a._trigger("chunkdone",null,i),a._trigger("chunkalways",null,i),s>l?r():d.resolveWith(i.context,[n,o,p])}).fail(function(e,t,n){i.jqXHR=e,i.textStatus=t,i.errorThrown=n,a._trigger("chunkfail",null,i),a._trigger("chunkalways",null,i),d.rejectWith(i.context,[e,t,n])})},this._enhancePromise(c),c.abort=function(){return n.abort()},r(),c):!1},_beforeSend:function(e,t){0===this._active&&(this._trigger("start"),this._bitrateTimer=new this._BitrateTimer,this._progress.loaded=this._progress.total=0,this._progress.bitrate=0),this._initResponseObject(t),this._initProgressObject(t),t._progress.loaded=t.loaded=t.uploadedBytes||0,t._progress.total=t.total=this._getTotal(t.files)||1,t._progress.bitrate=t.bitrate=0,this._active+=1,this._progress.loaded+=t.loaded,this._progress.total+=t.total},_onDone:function(t,i,n,r){var a=r._progress.total,o=r._response;r._progress.loaded<a&&this._onProgress(e.Event("progress",{lengthComputable:!0,loaded:a,total:a}),r),o.result=r.result=t,o.textStatus=r.textStatus=i,o.jqXHR=r.jqXHR=n,this._trigger("done",null,r)},_onFail:function(e,t,i,n){var r=n._response;n.recalculateProgress&&(this._progress.loaded-=n._progress.loaded,this._progress.total-=n._progress.total),r.jqXHR=n.jqXHR=e,r.textStatus=n.textStatus=t,r.errorThrown=n.errorThrown=i,this._trigger("fail",null,n)},_onAlways:function(e,t,i,n){this._trigger("always",null,n)},_onSend:function(t,i){i.submit||this._addConvenienceMethods(t,i);var n,r,a,o,s=this,l=s._getAJAXSettings(i),p=function(){return s._sending+=1,l._bitrateTimer=new s._BitrateTimer,n=n||((r||s._trigger("send",e.Event("send",{delegatedEvent:t}),l)===!1)&&s._getXHRPromise(!1,l.context,r)||s._chunkedUpload(l)||e.ajax(l)).done(function(e,t,i){s._onDone(e,t,i,l)}).fail(function(e,t,i){s._onFail(e,t,i,l)}).always(function(e,t,i){if(s._onAlways(e,t,i,l),s._sending-=1,s._active-=1,l.limitConcurrentUploads&&l.limitConcurrentUploads>s._sending)for(var n=s._slots.shift();n;){if("pending"===s._getDeferredState(n)){n.resolve();break}n=s._slots.shift()}0===s._active&&s._trigger("stop")})};return this._beforeSend(t,l),this.options.sequentialUploads||this.options.limitConcurrentUploads&&this.options.limitConcurrentUploads<=this._sending?(this.options.limitConcurrentUploads>1?(a=e.Deferred(),this._slots.push(a),o=a.pipe(p)):(this._sequence=this._sequence.pipe(p,p),o=this._sequence),o.abort=function(){return r=[void 0,"abort","abort"],n?n.abort():(a&&a.rejectWith(l.context,r),p())},this._enhancePromise(o)):p()},_onAdd:function(t,i){var n,r,a,o,s=this,l=!0,p=e.extend({},this.options,i),u=i.files,d=u.length,c=p.limitMultiFileUploads,f=p.limitMultiFileUploadSize,g=p.limitMultiFileUploadSizeOverhead,h=0,m=this._getParamName(p),v=0;if(!d)return!1;if(f&&void 0===u[0].size&&(f=void 0),(p.singleFileUploads||c||f)&&this._isXHRUpload(p))if(p.singleFileUploads||f||!c)if(!p.singleFileUploads&&f)for(a=[],n=[],o=0;d>o;o+=1)h+=u[o].size+g,(o+1===d||h+u[o+1].size+g>f||c&&o+1-v>=c)&&(a.push(u.slice(v,o+1)),r=m.slice(v,o+1),r.length||(r=m),n.push(r),v=o+1,h=0);else n=m;else for(a=[],n=[],o=0;d>o;o+=c)a.push(u.slice(o,o+c)),r=m.slice(o,o+c),r.length||(r=m),n.push(r);else a=[u],n=[m];return i.originalFiles=u,e.each(a||u,function(r,o){var p=e.extend({},i);return p.files=a?o:[o],p.paramName=n[r],s._initResponseObject(p),s._initProgressObject(p),s._addConvenienceMethods(t,p),l=s._trigger("add",e.Event("add",{delegatedEvent:t}),p)}),l},_replaceFileInput:function(t){var i=t.fileInput,n=i.clone(!0),r=i.is(document.activeElement);t.fileInputClone=n,e("<form></form>").append(n)[0].reset(),i.after(n).detach(),r&&n.focus(),e.cleanData(i.unbind("remove")),this.options.fileInput=this.options.fileInput.map(function(e,t){return t===i[0]?n[0]:t}),i[0]===this.element[0]&&(this.element=n)},_handleFileTreeEntry:function(t,i){var n,r=this,a=e.Deferred(),o=function(e){e&&!e.entry&&(e.entry=t),a.resolve([e])},s=function(e){r._handleFileTreeEntries(e,i+t.name+"/").done(function(e){a.resolve(e)}).fail(o)},l=function(){n.readEntries(function(e){e.length?(p=p.concat(e),l()):s(p)},o)},p=[];return i=i||"",t.isFile?t._file?(t._file.relativePath=i,a.resolve(t._file)):t.file(function(e){e.relativePath=i,a.resolve(e)},o):t.isDirectory?(n=t.createReader(),l()):a.resolve([]),a.promise()},_handleFileTreeEntries:function(t,i){var n=this;return e.when.apply(e,e.map(t,function(e){return n._handleFileTreeEntry(e,i)})).pipe(function(){return Array.prototype.concat.apply([],arguments)})},_getDroppedFiles:function(t){t=t||{};var i=t.items;return i&&i.length&&(i[0].webkitGetAsEntry||i[0].getAsEntry)?this._handleFileTreeEntries(e.map(i,function(e){var t;return e.webkitGetAsEntry?(t=e.webkitGetAsEntry(),t&&(t._file=e.getAsFile()),t):e.getAsEntry()})):e.Deferred().resolve(e.makeArray(t.files)).promise()},_getSingleFileInputFiles:function(t){t=e(t);var i,n,r=t.prop("webkitEntries")||t.prop("entries");if(r&&r.length)return this._handleFileTreeEntries(r);if(i=e.makeArray(t.prop("files")),i.length)void 0===i[0].name&&i[0].fileName&&e.each(i,function(e,t){t.name=t.fileName,t.size=t.fileSize});else{if(n=t.prop("value"),!n)return e.Deferred().resolve([]).promise();i=[{name:n.replace(/^.*\\/,"")}]}return e.Deferred().resolve(i).promise()},_getFileInputFiles:function(t){return t instanceof e&&1!==t.length?e.when.apply(e,e.map(t,this._getSingleFileInputFiles)).pipe(function(){return Array.prototype.concat.apply([],arguments)}):this._getSingleFileInputFiles(t)},_onChange:function(t){var i=this,n={fileInput:e(t.target),form:e(t.target.form)};this._getFileInputFiles(n.fileInput).always(function(r){n.files=r,i.options.replaceFileInput&&i._replaceFileInput(n),i._trigger("change",e.Event("change",{delegatedEvent:t}),n)!==!1&&i._onAdd(t,n)})},_onPaste:function(t){var i=t.originalEvent&&t.originalEvent.clipboardData&&t.originalEvent.clipboardData.items,n={files:[]};i&&i.length&&(e.each(i,function(e,t){var i=t.getAsFile&&t.getAsFile();i&&n.files.push(i)}),this._trigger("paste",e.Event("paste",{delegatedEvent:t}),n)!==!1&&this._onAdd(t,n))},_onDrop:function(t){t.dataTransfer=t.originalEvent&&t.originalEvent.dataTransfer;var i=this,n=t.dataTransfer,r={};n&&n.files&&n.files.length&&(t.preventDefault(),this._getDroppedFiles(n).always(function(n){r.files=n,i._trigger("drop",e.Event("drop",{delegatedEvent:t}),r)!==!1&&i._onAdd(t,r)}))},_onDragOver:t("dragover"),_onDragEnter:t("dragenter"),_onDragLeave:t("dragleave"),_initEventHandlers:function(){this._isXHRUpload(this.options)&&(this._on(this.options.dropZone,{dragover:this._onDragOver,drop:this._onDrop,dragenter:this._onDragEnter,dragleave:this._onDragLeave}),this._on(this.options.pasteZone,{paste:this._onPaste})),e.support.fileInput&&this._on(this.options.fileInput,{change:this._onChange})},_destroyEventHandlers:function(){this._off(this.options.dropZone,"dragenter dragleave dragover drop"),this._off(this.options.pasteZone,"paste"),this._off(this.options.fileInput,"change")},_setOption:function(t,i){var n=-1!==e.inArray(t,this._specialOptions);n&&this._destroyEventHandlers(),this._super(t,i),n&&(this._initSpecialOptions(),this._initEventHandlers())},_initSpecialOptions:function(){var t=this.options;void 0===t.fileInput?t.fileInput=this.element.is('input[type="file"]')?this.element:this.element.find('input[type="file"]'):t.fileInput instanceof e||(t.fileInput=e(t.fileInput)),t.dropZone instanceof e||(t.dropZone=e(t.dropZone)),t.pasteZone instanceof e||(t.pasteZone=e(t.pasteZone))},_getRegExp:function(e){var t=e.split("/"),i=t.pop();return t.shift(),new RegExp(t.join("/"),i)},_isRegExpOption:function(t,i){return"url"!==t&&"string"===e.type(i)&&/^\/.*\/[igm]{0,3}$/.test(i)},_initDataAttributes:function(){var t=this,i=this.options,n=this.element.data();e.each(this.element[0].attributes,function(e,r){var a,o=r.name.toLowerCase();/^data-/.test(o)&&(o=o.slice(5).replace(/-[a-z]/g,function(e){return e.charAt(1).toUpperCase()}),a=n[o],t._isRegExpOption(o,a)&&(a=t._getRegExp(a)),i[o]=a)})},_create:function(){this._initDataAttributes(),this._initSpecialOptions(),this._slots=[],this._sequence=this._getXHRPromise(!0),this._sending=this._active=0,this._initProgressObject(this),this._initEventHandlers()},active:function(){return this._active},progress:function(){return this._progress},add:function(t){var i=this;t&&!this.options.disabled&&(t.fileInput&&!t.files?this._getFileInputFiles(t.fileInput).always(function(e){t.files=e,i._onAdd(null,t)}):(t.files=e.makeArray(t.files),this._onAdd(null,t)))},send:function(t){if(t&&!this.options.disabled){if(t.fileInput&&!t.files){var i,n,r=this,a=e.Deferred(),o=a.promise();return o.abort=function(){return n=!0,i?i.abort():(a.reject(null,"abort","abort"),o)},this._getFileInputFiles(t.fileInput).always(function(e){if(!n){if(!e.length)return void a.reject();t.files=e,i=r._onSend(null,t),i.then(function(e,t,i){a.resolve(e,t,i)},function(e,t,i){a.reject(e,t,i)})}}),this._enhancePromise(o)}if(t.files=e.makeArray(t.files),t.files.length)return this._onSend(null,t)}return this._getXHRPromise(!1,t&&t.context)}})}),function(e){"use strict";e(window.jQuery)}(function(e){"use strict";var t=e.blueimp.fileupload.prototype.options.add;e.widget("blueimp.fileupload",e.blueimp.fileupload,{options:{processQueue:[],add:function(i,n){var r=e(this);n.process(function(){return r.fileupload("process",n)}),t.call(this,i,n)}},processActions:{},_processFile:function(t,i){var n=this,r=e.Deferred().resolveWith(n,[t]),a=r.promise();return this._trigger("process",null,t),e.each(t.processQueue,function(t,r){var o=function(t){return i.errorThrown?e.Deferred().rejectWith(n,[i]).promise():n.processActions[r.action].call(n,t,r)};a=a.pipe(o,r.always&&o)}),a.done(function(){n._trigger("processdone",null,t),n._trigger("processalways",null,t)}).fail(function(){n._trigger("processfail",null,t),n._trigger("processalways",null,t)}),a},_transformProcessQueue:function(t){var i=[];e.each(t.processQueue,function(){var n={},r=this.action,a=this.prefix===!0?r:this.prefix;e.each(this,function(i,r){"string"===e.type(r)&&"@"===r.charAt(0)?n[i]=t[r.slice(1)||(a?a+i.charAt(0).toUpperCase()+i.slice(1):i)]:n[i]=r}),i.push(n)}),t.processQueue=i},processing:function(){return this._processing},process:function(t){var i=this,n=e.extend({},this.options,t);return n.processQueue&&n.processQueue.length&&(this._transformProcessQueue(n),0===this._processing&&this._trigger("processstart"),e.each(t.files,function(r){var a=r?e.extend({},n):n,o=function(){return t.errorThrown?e.Deferred().rejectWith(i,[t]).promise():i._processFile(a,t)};a.index=r,i._processing+=1,i._processingQueue=i._processingQueue.pipe(o,o).always(function(){i._processing-=1,0===i._processing&&i._trigger("processstop")})})),this._processingQueue},_create:function(){this._super(),this._processing=0,this._processingQueue=e.Deferred().resolveWith(this).promise()}})}),function(e){"use strict";e(window.jQuery,window.loadImage)}(function(e,t){"use strict";e.blueimp.fileupload.prototype.options.processQueue.unshift({action:"loadImageMetaData",disableImageHead:"@",disableExif:"@",disableExifThumbnail:"@",disableExifSub:"@",disableExifGps:"@",disabled:"@disableImageMetaDataLoad"},{action:"loadImage",prefix:!0,fileTypes:"@",maxFileSize:"@",noRevoke:"@",disabled:"@disableImageLoad"},{action:"resizeImage",prefix:"image",maxWidth:"@",maxHeight:"@",minWidth:"@",minHeight:"@",crop:"@",orientation:"@",forceResize:"@",disabled:"@disableImageResize"},{action:"saveImage",quality:"@imageQuality",type:"@imageType",disabled:"@disableImageResize"},{action:"saveImageMetaData",disabled:"@disableImageMetaDataSave"},{action:"resizeImage",prefix:"preview",maxWidth:"@",maxHeight:"@",minWidth:"@",minHeight:"@",crop:"@",orientation:"@",thumbnail:"@",canvas:"@",disabled:"@disableImagePreview"},{action:"setImage",name:"@imagePreviewName",disabled:"@disableImagePreview"},{action:"deleteImageReferences",disabled:"@disableImageReferencesDeletion"}),e.widget("blueimp.fileupload",e.blueimp.fileupload,{options:{loadImageFileTypes:/^image\/(gif|jpeg|png|svg\+xml)$/,loadImageMaxFileSize:1e7,imageMaxWidth:1920,imageMaxHeight:1080,imageOrientation:!1,imageCrop:!1,disableImageResize:!0,previewMaxWidth:80,previewMaxHeight:80,previewOrientation:!0,previewThumbnail:!0,previewCrop:!1,previewCanvas:!0},processActions:{loadImage:function(i,n){if(n.disabled)return i;var r=this,a=i.files[i.index],o=e.Deferred();return"number"===e.type(n.maxFileSize)&&a.size>n.maxFileSize||n.fileTypes&&!n.fileTypes.test(a.type)||!t(a,function(e){e.src&&(i.img=e),o.resolveWith(r,[i])},n)?i:o.promise()},resizeImage:function(i,n){if(n.disabled||!i.canvas&&!i.img)return i;n=e.extend({canvas:!0},n);var r,a=this,o=e.Deferred(),s=n.canvas&&i.canvas||i.img,l=function(e){e&&(e.width!==s.width||e.height!==s.height||n.forceResize)&&(i[e.getContext?"canvas":"img"]=e),i.preview=e,o.resolveWith(a,[i])};if(i.exif){if(n.orientation===!0&&(n.orientation=i.exif.get("Orientation")),n.thumbnail&&(r=i.exif.get("Thumbnail")))return t(r,l,n),o.promise();i.orientation?delete n.orientation:i.orientation=n.orientation}return s?(l(t.scale(s,n)),o.promise()):i},saveImage:function(t,i){if(!t.canvas||i.disabled)return t;var n=this,r=t.files[t.index],a=e.Deferred();return t.canvas.toBlob?(t.canvas.toBlob(function(e){e.name||(r.type===e.type?e.name=r.name:r.name&&(e.name=r.name.replace(/\.\w+$/,"."+e.type.substr(6)))),r.type!==e.type&&delete t.imageHead,t.files[t.index]=e,a.resolveWith(n,[t])},i.type||r.type,i.quality),a.promise()):t},loadImageMetaData:function(i,n){if(n.disabled)return i;var r=this,a=e.Deferred();return t.parseMetaData(i.files[i.index],function(t){e.extend(i,t),a.resolveWith(r,[i])},n),a.promise()},saveImageMetaData:function(e,t){if(!(e.imageHead&&e.canvas&&e.canvas.toBlob)||t.disabled)return e;var i=e.files[e.index],n=new Blob([e.imageHead,this._blobSlice.call(i,20)],{type:i.type});return n.name=i.name,e.files[e.index]=n,e},setImage:function(e,t){return e.preview&&!t.disabled&&(e.files[e.index][t.name||"preview"]=e.preview),e},deleteImageReferences:function(e,t){return t.disabled||(delete e.img,delete e.canvas,delete e.preview,delete e.imageHead),e}}})});